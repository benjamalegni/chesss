{"ast":null,"code":"import { argsert } from './argsert.js';\nimport { isPromise } from './utils/is-promise.js';\nexport function globalMiddlewareFactory(globalMiddleware, context) {\n  return function (callback, applyBeforeValidation = false) {\n    argsert('<array|function> [boolean]', [callback, applyBeforeValidation], arguments.length);\n    if (Array.isArray(callback)) {\n      for (let i = 0; i < callback.length; i++) {\n        if (typeof callback[i] !== 'function') {\n          throw Error('middleware must be a function');\n        }\n        callback[i].applyBeforeValidation = applyBeforeValidation;\n      }\n      Array.prototype.push.apply(globalMiddleware, callback);\n    } else if (typeof callback === 'function') {\n      callback.applyBeforeValidation = applyBeforeValidation;\n      globalMiddleware.push(callback);\n    }\n    return context;\n  };\n}\nexport function commandMiddlewareFactory(commandMiddleware) {\n  if (!commandMiddleware) return [];\n  return commandMiddleware.map(middleware => {\n    middleware.applyBeforeValidation = false;\n    return middleware;\n  });\n}\nexport function applyMiddleware(argv, yargs, middlewares, beforeValidation) {\n  const beforeValidationError = new Error('middleware cannot return a promise when applyBeforeValidation is true');\n  return middlewares.reduce((acc, middleware) => {\n    if (middleware.applyBeforeValidation !== beforeValidation) {\n      return acc;\n    }\n    if (isPromise(acc)) {\n      return acc.then(initialObj => Promise.all([initialObj, middleware(initialObj, yargs)])).then(([initialObj, middlewareObj]) => Object.assign(initialObj, middlewareObj));\n    } else {\n      const result = middleware(acc, yargs);\n      if (beforeValidation && isPromise(result)) throw beforeValidationError;\n      return isPromise(result) ? result.then(middlewareObj => Object.assign(acc, middlewareObj)) : Object.assign(acc, result);\n    }\n  }, argv);\n}","map":{"version":3,"names":["argsert","isPromise","globalMiddlewareFactory","globalMiddleware","context","callback","applyBeforeValidation","arguments","length","Array","isArray","i","Error","prototype","push","apply","commandMiddlewareFactory","commandMiddleware","map","middleware","applyMiddleware","argv","yargs","middlewares","beforeValidation","beforeValidationError","reduce","acc","then","initialObj","Promise","all","middlewareObj","Object","assign","result"],"sources":["/home/outer/Documents/chesss/node_modules/yargs/build/lib/middleware.js"],"sourcesContent":["import { argsert } from './argsert.js';\nimport { isPromise } from './utils/is-promise.js';\nexport function globalMiddlewareFactory(globalMiddleware, context) {\n    return function (callback, applyBeforeValidation = false) {\n        argsert('<array|function> [boolean]', [callback, applyBeforeValidation], arguments.length);\n        if (Array.isArray(callback)) {\n            for (let i = 0; i < callback.length; i++) {\n                if (typeof callback[i] !== 'function') {\n                    throw Error('middleware must be a function');\n                }\n                callback[i].applyBeforeValidation = applyBeforeValidation;\n            }\n            Array.prototype.push.apply(globalMiddleware, callback);\n        }\n        else if (typeof callback === 'function') {\n            callback.applyBeforeValidation = applyBeforeValidation;\n            globalMiddleware.push(callback);\n        }\n        return context;\n    };\n}\nexport function commandMiddlewareFactory(commandMiddleware) {\n    if (!commandMiddleware)\n        return [];\n    return commandMiddleware.map(middleware => {\n        middleware.applyBeforeValidation = false;\n        return middleware;\n    });\n}\nexport function applyMiddleware(argv, yargs, middlewares, beforeValidation) {\n    const beforeValidationError = new Error('middleware cannot return a promise when applyBeforeValidation is true');\n    return middlewares.reduce((acc, middleware) => {\n        if (middleware.applyBeforeValidation !== beforeValidation) {\n            return acc;\n        }\n        if (isPromise(acc)) {\n            return acc\n                .then(initialObj => Promise.all([\n                initialObj,\n                middleware(initialObj, yargs),\n            ]))\n                .then(([initialObj, middlewareObj]) => Object.assign(initialObj, middlewareObj));\n        }\n        else {\n            const result = middleware(acc, yargs);\n            if (beforeValidation && isPromise(result))\n                throw beforeValidationError;\n            return isPromise(result)\n                ? result.then(middlewareObj => Object.assign(acc, middlewareObj))\n                : Object.assign(acc, result);\n        }\n    }, argv);\n}\n"],"mappings":"AAAA,SAASA,OAAO,QAAQ,cAAc;AACtC,SAASC,SAAS,QAAQ,uBAAuB;AACjD,OAAO,SAASC,uBAAuBA,CAACC,gBAAgB,EAAEC,OAAO,EAAE;EAC/D,OAAO,UAAUC,QAAQ,EAAEC,qBAAqB,GAAG,KAAK,EAAE;IACtDN,OAAO,CAAC,4BAA4B,EAAE,CAACK,QAAQ,EAAEC,qBAAqB,CAAC,EAAEC,SAAS,CAACC,MAAM,CAAC;IAC1F,IAAIC,KAAK,CAACC,OAAO,CAACL,QAAQ,CAAC,EAAE;MACzB,KAAK,IAAIM,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGN,QAAQ,CAACG,MAAM,EAAEG,CAAC,EAAE,EAAE;QACtC,IAAI,OAAON,QAAQ,CAACM,CAAC,CAAC,KAAK,UAAU,EAAE;UACnC,MAAMC,KAAK,CAAC,+BAA+B,CAAC;QAChD;QACAP,QAAQ,CAACM,CAAC,CAAC,CAACL,qBAAqB,GAAGA,qBAAqB;MAC7D;MACAG,KAAK,CAACI,SAAS,CAACC,IAAI,CAACC,KAAK,CAACZ,gBAAgB,EAAEE,QAAQ,CAAC;IAC1D,CAAC,MACI,IAAI,OAAOA,QAAQ,KAAK,UAAU,EAAE;MACrCA,QAAQ,CAACC,qBAAqB,GAAGA,qBAAqB;MACtDH,gBAAgB,CAACW,IAAI,CAACT,QAAQ,CAAC;IACnC;IACA,OAAOD,OAAO;EAClB,CAAC;AACL;AACA,OAAO,SAASY,wBAAwBA,CAACC,iBAAiB,EAAE;EACxD,IAAI,CAACA,iBAAiB,EAClB,OAAO,EAAE;EACb,OAAOA,iBAAiB,CAACC,GAAG,CAACC,UAAU,IAAI;IACvCA,UAAU,CAACb,qBAAqB,GAAG,KAAK;IACxC,OAAOa,UAAU;EACrB,CAAC,CAAC;AACN;AACA,OAAO,SAASC,eAAeA,CAACC,IAAI,EAAEC,KAAK,EAAEC,WAAW,EAAEC,gBAAgB,EAAE;EACxE,MAAMC,qBAAqB,GAAG,IAAIb,KAAK,CAAC,uEAAuE,CAAC;EAChH,OAAOW,WAAW,CAACG,MAAM,CAAC,CAACC,GAAG,EAAER,UAAU,KAAK;IAC3C,IAAIA,UAAU,CAACb,qBAAqB,KAAKkB,gBAAgB,EAAE;MACvD,OAAOG,GAAG;IACd;IACA,IAAI1B,SAAS,CAAC0B,GAAG,CAAC,EAAE;MAChB,OAAOA,GAAG,CACLC,IAAI,CAACC,UAAU,IAAIC,OAAO,CAACC,GAAG,CAAC,CAChCF,UAAU,EACVV,UAAU,CAACU,UAAU,EAAEP,KAAK,CAAC,CAChC,CAAC,CAAC,CACEM,IAAI,CAAC,CAAC,CAACC,UAAU,EAAEG,aAAa,CAAC,KAAKC,MAAM,CAACC,MAAM,CAACL,UAAU,EAAEG,aAAa,CAAC,CAAC;IACxF,CAAC,MACI;MACD,MAAMG,MAAM,GAAGhB,UAAU,CAACQ,GAAG,EAAEL,KAAK,CAAC;MACrC,IAAIE,gBAAgB,IAAIvB,SAAS,CAACkC,MAAM,CAAC,EACrC,MAAMV,qBAAqB;MAC/B,OAAOxB,SAAS,CAACkC,MAAM,CAAC,GAClBA,MAAM,CAACP,IAAI,CAACI,aAAa,IAAIC,MAAM,CAACC,MAAM,CAACP,GAAG,EAAEK,aAAa,CAAC,CAAC,GAC/DC,MAAM,CAACC,MAAM,CAACP,GAAG,EAAEQ,MAAM,CAAC;IACpC;EACJ,CAAC,EAAEd,IAAI,CAAC;AACZ","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}